<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Inbox - Sentinel Shield Protected</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --safe: #38a169;
            --warning: #d69e2e;
            --danger: #e53e3e;
            --primary: #2c5282;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: #f7fafc;
            color: #1a202c;
            min-height: 100vh;
        }

        /* Top Security Banner */
        .security-banner {
            background: linear-gradient(135deg, #1a365d, #2c5282);
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .security-banner .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .security-status {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(56, 161, 105, 0.2);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .security-status.protected::before {
            content: "‚óè";
            color: #68d391;
        }

        /* Email List */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .inbox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .inbox-header h1 {
            color: var(--primary);
        }

        .email-list {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .email-item {
            display: flex;
            align-items: flex-start;
            padding: 16px 20px;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: background 0.2s;
            gap: 15px;
        }

        .email-item:hover {
            background: #f7fafc;
        }

        .email-item.selected {
            background: #ebf8ff;
        }

        /* Warning indicator on email row */
        .email-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-top: 8px;
            flex-shrink: 0;
        }

        .email-indicator.safe {
            background: var(--safe);
        }

        .email-indicator.warning {
            background: var(--warning);
        }

        .email-indicator.danger {
            background: var(--danger);
        }

        .email-content {
            flex: 1;
        }

        .email-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .email-sender {
            font-weight: 600;
        }

        .email-time {
            color: #718096;
            font-size: 0.85rem;
        }

        .email-subject {
            margin-bottom: 4px;
        }

        .email-preview {
            color: #718096;
            font-size: 0.9rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Warning badge on email row */
        .email-warning-badge {
            background: #fef3c7;
            color: #92400e;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
        }

        /* Email View Panel */
        .email-view {
            display: none;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-top: 20px;
            overflow: hidden;
        }

        .email-view.active {
            display: block;
        }

        /* Warning Banner for suspicious emails */
        .warning-banner {
            padding: 16px 20px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .warning-banner.suspicious {
            background: linear-gradient(135deg, #fef3c7, #fefcbf);
            border-bottom: 3px solid var(--warning);
        }

        .warning-banner.caution {
            background: linear-gradient(135deg, #fed7d7, #fff5f5);
            border-bottom: 3px solid var(--danger);
        }

        .warning-banner.safe {
            background: linear-gradient(135deg, #c6f6d5, #f0fff4);
            border-bottom: 3px solid var(--safe);
        }

        .warning-icon {
            font-size: 1.5rem;
        }

        .warning-content {
            flex: 1;
        }

        .warning-content h4 {
            margin-bottom: 4px;
        }

        .warning-content p {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .warning-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .warning-actions button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.85rem;
        }

        .btn-report {
            background: var(--danger);
            color: white;
        }

        .btn-trust {
            background: var(--safe);
            color: white;
        }

        .btn-details {
            background: #e2e8f0;
            color: #4a5568;
        }

        /* Email metadata */
        .email-meta {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .email-meta table {
            width: 100%;
        }

        .email-meta th {
            text-align: left;
            width: 80px;
            color: #718096;
            font-weight: 500;
            padding: 6px 0;
        }

        .email-meta td {
            padding: 6px 0;
        }

        /* Email body with inline highlights */
        .email-body {
            padding: 24px;
            line-height: 1.7;
        }

        /* Inline threat highlights - visible to user */
        .highlight-urgency {
            background: linear-gradient(180deg, transparent 60%, #fed7d7 60%);
            padding: 0 2px;
        }

        .highlight-sensitive {
            background: linear-gradient(180deg, transparent 60%, #fef3c7 60%);
            padding: 0 2px;
        }

        .highlight-suspicious {
            background: linear-gradient(180deg, transparent 60%, #e2e8f0 60%);
            padding: 0 2px;
        }

        /* Link warnings */
        .link-warning {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: #fef3c7;
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px dashed #d69e2e;
            text-decoration: none;
            color: #92400e;
        }

        .link-warning::before {
            content: "‚ö†Ô∏è";
        }

        .link-blocked {
            background: #fed7d7;
            border-color: var(--danger);
            color: #9b2c2c;
            text-decoration: line-through;
            cursor: not-allowed;
        }

        .link-blocked::before {
            content: "üö´";
        }

        /* Threat explanation tooltip */
        .threat-tooltip {
            position: fixed;
            background: #1a202c;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            max-width: 300px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: none;
        }

        /* Legend */
        .legend {
            background: #f7fafc;
            padding: 15px 20px;
            font-size: 0.85rem;
            border-top: 1px solid #e2e8f0;
        }

        .legend-title {
            font-weight: 600;
            margin-bottom: 10px;
        }

        .legend-items {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 12px;
            border-radius: 2px;
        }

        /* User info */
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>

<body>
    <!-- Security Banner -->
    <div class="security-banner">
        <div class="logo">
            üõ°Ô∏è <span>Sentinel Shield</span>
        </div>
        <div class="security-status protected">
            Protected - All emails scanned
        </div>
        <div class="user-info">
            <span id="userName">John Smith</span>
            <div class="user-avatar">J</div>
        </div>
    </div>

    <!-- Tooltip for threat explanations -->
    <div class="threat-tooltip" id="tooltip"></div>

    <div class="container">
        <div class="inbox-header">
            <h1>üì¨ Inbox</h1>
            <span style="color:#718096">Click an email to view with security analysis</span>
        </div>

        <!-- Email List -->
        <div class="email-list" id="emailList"></div>

        <!-- Email View Panel -->
        <div class="email-view" id="emailView"></div>
    </div>

    <script>
        // Client inbox with borderline emails that passed but need warnings
        const CLIENT_EMAILS = [
            {
                id: 1,
                sender: 'hr@company.com',
                senderName: 'HR Department',
                subject: 'Benefits Enrollment Reminder',
                body: '<p>Dear Team,</p><p>This is a reminder that benefits enrollment ends next Friday. Please log into the HR portal to make your selections.</p><p>Best,<br>HR Team</p>',
                time: '9:15 AM',
                threatLevel: 'safe',
                threats: []
            },
            {
                id: 2,
                sender: 'support@bankofamerica-secure.com',
                senderName: 'Bank of America',
                subject: 'Important: Please Verify Your Account',
                body: '<p>Dear Valued Customer,</p><p>We noticed some <span class="highlight-urgency" title="Urgency tactic detected">unusual activity</span> on your account. Please <span class="highlight-sensitive" title="Requests action that could compromise security">verify your account</span> by clicking the link below:</p><p><a href="http://boa-secure-login.xyz/verify" class="link-blocked" onclick="return false;" title="üö´ BLOCKED: Suspicious domain - not official Bank of America">http://boa-secure-login.xyz/verify</a></p><p>If you don\'t verify within <span class="highlight-urgency" title="Urgency tactic">24 hours</span>, your account will be suspended.</p>',
                time: '8:45 AM',
                threatLevel: 'danger',
                threats: ['Brand impersonation', 'Urgency language', 'Suspicious link'],
                warnings: ['Sender domain does not match Bank of America', 'Link leads to suspicious website', 'Creates false urgency'],
                blocked: true
            },
            {
                id: 3,
                sender: 'newsletter@marketing-promo.io',
                senderName: 'Weekly Deals',
                subject: 'Exclusive Offer Just for You!',
                body: '<p>Hi there!</p><p><span class="highlight-suspicious" title="Common marketing phrase">Exclusive deal</span> just for you! Click below to claim your <span class="highlight-suspicious" title="Too good to be true offer">FREE gift</span>:</p><p><a href="http://bit.ly/deal123" class="link-warning" onclick="showLinkWarning(event, this)" title="‚ö†Ô∏è WARNING: URL shortener hides destination">http://bit.ly/deal123</a></p><p>Hurry, <span class="highlight-urgency" title="Creates false urgency">offer expires today</span>!</p>',
                time: '8:30 AM',
                threatLevel: 'warning',
                threats: ['URL shortener'],
                warnings: ['Link uses URL shortener (destination hidden)', 'Uses urgency tactics'],
                blocked: false
            },
            {
                id: 4,
                sender: 'invoices@acme-supplier.net',
                senderName: 'ACME Supplier',
                subject: 'Invoice #4521 - Payment Due',
                body: '<p>Dear Accounts Team,</p><p>Please find attached invoice #4521 for $3,450.00.</p><p>Payment is due within 30 days.</p><p>Attached: Invoice_4521.pdf</p><p>Thank you for your business.</p>',
                time: '8:00 AM',
                threatLevel: 'warning',
                threats: ['First-time sender'],
                warnings: ['This is the first email from this sender', 'Contains attachment'],
                blocked: false
            },
            {
                id: 5,
                sender: 'cfo@company-internal.ml',
                senderName: 'CFO Michael Roberts',
                subject: 'Urgent Wire Transfer Needed',
                body: '<p>Hi,</p><p>I need you to process an <span class="highlight-urgency" title="Urgency tactic">urgent wire transfer</span> for $15,000 to a new vendor. This is <span class="highlight-sensitive" title="Attempts to bypass normal verification">confidential</span> - don\'t share with anyone.</p><p>I\'m in meetings all day so can\'t call. <span class="highlight-urgency" title="Pressure tactic">Please do this ASAP</span>.</p><p>Thanks,<br>Michael<br><i>Sent from iPhone</i></p>',
                time: '7:45 AM',
                threatLevel: 'danger',
                threats: ['CEO/CFO fraud', 'Wire transfer request', 'Suspicious domain'],
                warnings: ['Sender domain .ml is high-risk', 'Requests urgent wire transfer', 'Asks you to keep secret', 'Executive impersonation attempt'],
                blocked: false  // Passed because some orgs have legitimate internal .ml domains
            },
            {
                id: 6,
                sender: 'john.smith@company.com',
                senderName: 'John Smith',
                subject: 'RE: Project Update',
                body: '<p>Thanks for the update! Looks good to me.</p><p>Let\'s discuss in our meeting tomorrow.</p><p>Best,<br>John</p>',
                time: '7:30 AM',
                threatLevel: 'safe',
                threats: []
            },
            {
                id: 7,
                sender: 'it-security@company.com',
                senderName: 'IT Security',
                subject: 'Password Expiry Notice',
                body: '<p>Hi,</p><p>Your password will expire in 7 days. Please update it through the company portal:</p><p><a href="https://portal.company.com/password">https://portal.company.com/password</a></p><p>IT Security Team</p>',
                time: '7:00 AM',
                threatLevel: 'safe',
                threats: []
            }
        ];

        // Render email list
        function renderEmailList() {
            const list = document.getElementById('emailList');
            list.innerHTML = CLIENT_EMAILS.map(email => {
                const indicatorClass = email.threatLevel === 'safe' ? 'safe' :
                    email.threatLevel === 'warning' ? 'warning' : 'danger';

                const badge = email.threatLevel === 'warning' ?
                    '<span class="email-warning-badge">‚ö†Ô∏è Review</span>' :
                    email.threatLevel === 'danger' ?
                        '<span class="email-warning-badge" style="background:#fed7d7;color:#9b2c2c">üö´ Threat</span>' : '';

                return `
                    <div class="email-item" onclick="viewEmail(${email.id})">
                        <div class="email-indicator ${indicatorClass}" title="${email.threatLevel}"></div>
                        <div class="email-content">
                            <div class="email-header">
                                <span class="email-sender">${email.senderName}</span>
                                <span class="email-time">${email.time}</span>
                            </div>
                            <div class="email-subject">${email.subject} ${badge}</div>
                            <div class="email-preview">${email.sender}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // View email with security analysis
        function viewEmail(id) {
            const email = CLIENT_EMAILS.find(e => e.id === id);
            if (!email) return;

            const view = document.getElementById('emailView');
            view.classList.add('active');

            // Determine warning banner
            let bannerHtml = '';
            if (email.threatLevel === 'danger') {
                bannerHtml = `
                    <div class="warning-banner caution">
                        <span class="warning-icon">üö®</span>
                        <div class="warning-content">
                            <h4>High Risk Email - Exercise Extreme Caution</h4>
                            <p>${email.warnings ? email.warnings.join('. ') : 'This email contains suspicious elements.'}</p>
                            <div class="warning-actions">
                                <button class="btn-report" onclick="reportEmail(${email.id})">üö´ Report as Phishing</button>
                                <button class="btn-details" onclick="showDetails(${email.id})">üîç View Threat Details</button>
                            </div>
                        </div>
                    </div>
                `;
            } else if (email.threatLevel === 'warning') {
                bannerHtml = `
                    <div class="warning-banner suspicious">
                        <span class="warning-icon">‚ö†Ô∏è</span>
                        <div class="warning-content">
                            <h4>Proceed with Caution</h4>
                            <p>${email.warnings ? email.warnings.join('. ') : 'Some elements of this email require your attention.'}</p>
                            <div class="warning-actions">
                                <button class="btn-report" onclick="reportEmail(${email.id})">üö´ Report</button>
                                <button class="btn-trust" onclick="trustEmail(${email.id})">‚úì Trust Sender</button>
                                <button class="btn-details" onclick="showDetails(${email.id})">üîç Details</button>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                bannerHtml = `
                    <div class="warning-banner safe">
                        <span class="warning-icon">‚úÖ</span>
                        <div class="warning-content">
                            <h4>Email Appears Safe</h4>
                            <p>No threats detected. Always verify before clicking links or opening attachments.</p>
                        </div>
                    </div>
                `;
            }

            view.innerHTML = `
                ${bannerHtml}
                
                <div class="email-meta">
                    <table>
                        <tr>
                            <th>From:</th>
                            <td><strong>${email.senderName}</strong> &lt;${email.sender}&gt;</td>
                        </tr>
                        <tr>
                            <th>Subject:</th>
                            <td><strong>${email.subject}</strong></td>
                        </tr>
                        <tr>
                            <th>Time:</th>
                            <td>${email.time}</td>
                        </tr>
                    </table>
                </div>
                
                <div class="email-body">
                    ${email.body}
                </div>
                
                <div class="legend">
                    <div class="legend-title">üîç Threat Highlighting Guide</div>
                    <div class="legend-items">
                        <div class="legend-item">
                            <span class="legend-color" style="background:linear-gradient(180deg, transparent 60%, #fed7d7 60%)"></span>
                            <span>Urgency/Pressure Tactics</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background:linear-gradient(180deg, transparent 60%, #fef3c7 60%)"></span>
                            <span>Sensitive Requests</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background:linear-gradient(180deg, transparent 60%, #e2e8f0 60%)"></span>
                            <span>Suspicious Phrases</span>
                        </div>
                        <div class="legend-item">
                            <span style="display:inline-block;padding:2px 6px;background:#fef3c7;border:1px dashed #d69e2e;border-radius:4px;font-size:0.8rem;">‚ö†Ô∏è Link</span>
                            <span>Suspicious Link (Hover for details)</span>
                        </div>
                        <div class="legend-item">
                            <span style="display:inline-block;padding:2px 6px;background:#fed7d7;border:1px dashed #e53e3e;border-radius:4px;font-size:0.8rem;text-decoration:line-through;">üö´ Link</span>
                            <span>Blocked Link (Click disabled)</span>
                        </div>
                    </div>
                </div>
            `;

            // Scroll to view
            view.scrollIntoView({ behavior: 'smooth' });
        }

        // Show tooltip on hover
        document.addEventListener('mouseover', (e) => {
            if (e.target.title && (e.target.classList.contains('highlight-urgency') ||
                e.target.classList.contains('highlight-sensitive') ||
                e.target.classList.contains('highlight-suspicious'))) {
                const tooltip = document.getElementById('tooltip');
                tooltip.textContent = e.target.title;
                tooltip.style.display = 'block';
                tooltip.style.left = e.pageX + 15 + 'px';
                tooltip.style.top = e.pageY + 15 + 'px';
            }
        });

        document.addEventListener('mouseout', (e) => {
            if (e.target.classList.contains('highlight-urgency') ||
                e.target.classList.contains('highlight-sensitive') ||
                e.target.classList.contains('highlight-suspicious')) {
                document.getElementById('tooltip').style.display = 'none';
            }
        });

        // Link warning popup
        function showLinkWarning(event, link) {
            event.preventDefault();
            const url = link.href;
            if (confirm('‚ö†Ô∏è WARNING: This link uses a URL shortener which hides the true destination.\n\nURL: ' + url + '\n\nDo you want to scan this link before visiting?')) {
                window.open('/api/v1/links/scan?url=' + encodeURIComponent(url), '_blank');
            }
        }

        function reportEmail(id) {
            alert('‚úì Email reported as phishing.\n\nThank you! This helps protect everyone.');
        }

        function trustEmail(id) {
            if (confirm('Add this sender to your trusted list?\n\nFuture emails from this sender will not show warnings.')) {
                alert('‚úì Sender added to trusted list.');
            }
        }

        function showDetails(id) {
            const email = CLIENT_EMAILS.find(e => e.id === id);
            if (email && email.warnings) {
                alert('üîç Threat Analysis:\n\n‚Ä¢ ' + email.warnings.join('\n‚Ä¢ '));
            }
        }

        // Initialize
        renderEmailList();
    </script>
</body>

</html>